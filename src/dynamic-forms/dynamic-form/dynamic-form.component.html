<div class="dynamic-form-container">
  <div *ngIf="scheme.length === 0" class="">FormScheme nao foi informado</div>
  <form *ngIf="started">
    <div *ngFor="let row of scheme; trackBy: trackByRowIndex" class="form-row">
      <div
        *ngFor="let field of row; trackBy: trackByFieldName"
        class="form-field"
      >
        <div class="form-label">
          <label [for]="getFieldId(field)"
            >{{ field.label }}
            <span>*</span>
          </label>
        </div>
        <div class="form-component">
          <ng-container
            *ngComponentOutlet="
            componentMap[field.type];
            injector: createFieldInjector(field)
          "
          >
          </ng-container>
        </div>
        <div
          class="form-msg"
          *ngIf="form?.get(field.name)?.invalid && form?.get(field.name)?.touched"
        >
          <span *ngIf="form?.get(field.name)?.errors?.['required']">
            Campo obrigat√≥rio
          </span>
          <span *ngIf="form?.get(field.name)?.errors?.['minlength']">
            M√≠nimo de {{
            form?.get(field.name)?.errors?.["minlength"]?.requiredLength }}
            caracteres
          </span>
          <span *ngIf="form?.get(field.name)?.errors?.['maxlength']">
            M√°ximo de {{
            form?.get(field.name)?.errors?.["maxlength"]?.requiredLength }}
            caracteres
          </span>
          <span *ngIf="form?.get(field.name)?.errors?.['min']">
            Valor m√≠nimo: {{ form?.get(field.name)?.errors?.["min"]?.min }}
          </span>
          <span *ngIf="form?.get(field.name)?.errors?.['max']">
            Valor m√°ximo: {{ form?.get(field.name)?.errors?.["max"]?.max }}
          </span>
          <span *ngIf="form?.get(field.name)?.errors?.['pattern']">
            Formato inv√°lido
          </span>
          <span *ngIf="form?.get(field.name)?.errors?.['email']">
            Email inv√°lido
          </span>
        </div>
      </div>
    </div>

    <!-- Status do formul√°rio -->
    <div class="form-status" *ngIf="isEditMode">
      <div class="status-info">
        <span class="mode-indicator">
          üìù Modo de Edi√ß√£o - ID: {{ currentFormData?.hash }}
        </span>
        <span class="changes-indicator" *ngIf="hasChanges">
          ‚ö†Ô∏è Altera√ß√µes n√£o salvas
        </span>
        <span class="no-changes-indicator" *ngIf="!hasChanges">
          ‚úÖ Sem altera√ß√µes
        </span>
      </div>
    </div>

    <!-- Se√ß√£o de exemplos para demonstrar funcionalidades -->
    <div class="examples-section">
      <h3>Exemplos de Uso:</h3>
      <div class="example-buttons">
        <button
          type="button"
          (click)="loadExampleCreateMode()"
          class="example-btn create-example"
        >
          üÜï Modo Cria√ß√£o
        </button>
        <button
          type="button"
          (click)="loadExampleEditMode()"
          class="example-btn edit-example"
        >
          ‚úèÔ∏è Carregar Exemplo Completo
        </button>
        <button
          type="button"
          (click)="loadExamplePartialData()"
          class="example-btn partial-example"
        >
          üìã Carregar Dados Parciais
        </button>
        <button
          type="button"
          (click)="debugFormState()"
          class="example-btn debug-example"
        >
          üîç Debug Estado
        </button>
      </div>
    </div>
  </form>
  <div class="form-actions">
    <button type="button" (click)="logFormData()" class="reset-btn">
      Log Form Data
    </button>
    <button
      type="submit"
      (click)="onSubmit()"
      [disabled]="form?.invalid || (isEditMode && !hasChanges)"
      class="submit-btn"
    >
      {{ isEditMode ? "Salvar Altera√ß√µes" : "Enviar Formul√°rio" }}
    </button>
    <button type="button" (click)="resetForm()" class="reset-btn">
      {{ isEditMode ? "Restaurar" : "Limpar" }}
    </button>
    <button
      type="button"
      (click)="clearFormData()"
      class="new-btn"
      *ngIf="isEditMode"
    >
      Novo
    </button>
  </div>
</div>
